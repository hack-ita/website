{{ define "main" }}

{{/* ================= HERO ================= */}}
<section class="pt-30 pb-10 px-5">
  {{ range first 1 (where .RegularPages "Params.featured" true) }}
  {{ $readingTime := math.Ceil (div (float .WordCount) 170) }}

  <div class="max-w-7xl mx-auto grid lg:grid-cols-5 gap-10">
    <article class="rounded-md col-span-3 py-20 px-5 bg-cover bg-center relative"
      style="background-image:url('{{ .Params.image | relURL }}')">
      <div class="absolute inset-0 bg-dark opacity-30 rounded-md"></div>
      <div class="relative flex flex-col gap-6">
        <h3 class="text-light hero-heading uppercase">{{ .Title }}</h3>
        <span class="text-light/80">
          {{ range first 1 .Params.tags }}{{ . }}{{ end }} /
          {{ range first 1 .Params.categories }}{{ . }}{{ end }}
        </span>
        <time class="text-light/80">{{ $readingTime }} min read</time>
      </div>
    </article>
  </div>
  {{ end }}
</section>

{{/* ================= LIST ================= */}}
{{/* cards */}}
<section class="max-w-7xl mx-auto py-10 px-5" aria-label="Exploits by category">

  {{ partial "components/search.html" . }}
  {{/*  {{ partial "components/filters.html" (dict "section" "blog" "site" .Site) }}  */}}

  <!-- NO RESULTS -->
  <div id="noResults"
       class="hidden py-20 text-center heading-sm text-dark dark:text-light">
    No results found.
  </div>

  <!-- ALL POSTS WRAPPER -->
  <div id="allPosts">

    {{ range .Site.Taxonomies.categories }}
    <div class="category-group">

      <div class="w-full h-0.5 bg-linear-to-r from-transparent via-primary to-transparent"></div>

      <div class="py-10">
        <header class="mb-5 flex gap-5 items-center justify-start">
          <span class="py-1 pl-9 pr-5 rounded-full text-sm border border-primary text-primary uppercase relative">
            <span class="absolute size-3 rounded bg-primary rotate-45 left-4 top-2"></span>
            <h3 class="inline">{{ .Page.Title }}</h3>
          </span>
          <p class="heading-sm text-dark dark:text-light">
            <span class="text-primary">Latest</span> Exploits
          </p>
        </header>

        <div class="grid grid-cols-2 lg:grid-cols-5 gap-5">

          {{ range .Pages }}
          {{ $readingTime := math.Ceil (div (float .WordCount) 170) }}

          <!-- ðŸ”´ CARD (UNCHANGED UI) -->
          <article
            class="post-item rounded-md flex flex-col border border-primary hover:scale-125 transition-transform relative hover:z-10"
            data-tags="{{ delimit (apply .Params.tags "urlize" ".") "," }}"
            data-categories="{{ delimit (apply .Params.categories "urlize" ".") "," }}"
          >
            <a href="{{ .RelPermalink }}" class="absolute inset-0 z-10"></a>

            <figure class="flex flex-col h-full">
              <div class="h-30 overflow-hidden rounded-t-md">
                {{ partial "components/image.html" (dict "src" .Params.image "alt" .Title "class" "size-full object-cover") }}
              </div>

              <figcaption class="bg-glass flex-1 p-3 flex flex-col gap-5 justify-between items-start">
                <div class="w-full flex justify-between items-center uppercase">
                  {{ range first 1 .Params.tags }}
                  <span class="rounded-full border border-primary px-3 py-1 text-primary text-xs">{{ . }}</span>
                  {{ end }}
                  <time class="text-dark dark:text-light text-sm">{{ $readingTime }} Min read</time>
                </div>

                <a href="{{ .RelPermalink }}" class="heading-sm text-primary">
                  {{ .Title }}
                </a>

                <p class="text-dark dark:text-light text-sm">{{ .Description }}</p>
              </figcaption>
            </figure>
          </article>

          {{ end }}

        </div>
      </div>
    </div>
    {{ end }}

  </div>
</section>

{{ end }}