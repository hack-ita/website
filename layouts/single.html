{{ define "main" }}
<img data-pagefind-meta="image[src]" src="{{ .Params.image | relURL }}" style="display:none">
<meta data-pagefind-meta="description[content]" content="{{ .Description }}">
<section class="bg-mask pt-30">
  <div class="lg:p-5 flex flex-col-reverse lg:flex-row gap-5 max-w-7xl mx-auto">

    <!-- Blog Post Content -->
    <article {{ if eq .Parent.Title "Blog" }}data-pagefind-body{{ end }} class="flex-4/6 bg-glass rounded-md border border-light/20 border-l-4 border-l-primary shadow-xl p-5">
      {{ partial "components/breadcrumb.html" . }}
      
      <header data-pagefind-ignore class="flex flex-col gap-5 items-start mt-5">
        <!-- Categories -->
        <div class="flex flex-wrap gap-2">
          {{ range .Params.categories }}
          <span class="px-3 py-1 text-primary border border-primary rounded-full uppercase">{{ . }}</span>
          {{ end }}
        </div>

        <!-- Title -->
        <h1 class="text-primary" data-pagefind-weight="10">{{ .Title }}</h1>

        <!-- Description -->
        {{ with .Description }}
        <p class="text-light text-pretty text-lg">{{ . }}</p>
        {{ end }}

        <!-- Meta Information -->
        <ul data-pagefind-ignore="" class="flex flex-wrap gap-5 items-stretch pb-5">
          {{ with .PublishDate }}
          <li class="py-1 px-3 text-light border border-light rounded-full text-sm uppercase">Pubblicato il {{ . }}</li>
          {{ end }}
          {{ $readingTime := div (float .WordCount) 170 }}
          {{ $readingTime = math.Ceil $readingTime }}
          <li class="py-1 px-3 text-light border border-light rounded-full text-sm uppercase">Tempo di lettura: {{ $readingTime }} min</li>
          {{ with .Params.author }}
          <li class="py-1 px-3 text-light border border-light rounded-full text-sm uppercase">Autore: {{ . }}</li>
          {{ end }}
        </ul>
      </header>

      <!-- Main Content -->
      <div class="pt-5 border-t border-light/20 prose prose-invert max-w-none">
        {{ .Content }}
      </div>

      <!-- Tags -->
      {{ if .Params.tags }}
      <footer data-pagefind-ignore="" class="pt-5 border-t border-light/20 flex gap-5 items-stretch w-full">
        {{ range .Params.tags }}
        <span class="px-3 py-1 rounded-full text-light text-sm border border-light">#{{ . }}</span>
        {{ end }}
      </footer>
      {{ end }}
    </article>

    <!-- Table of Contents -->
    <aside class="flex-2/6 relative">
      <div
        class="bg-glass rounded-md border border-light/20 border-l-4 border-l-primary shadow-xl p-5 sticky top-30 text-light lg:h-[80vh] lg:overflow-y-scroll"
        aria-label="Table of Contents">
        <h2 class="text-primary mb-3 hero-heading">Table Of Contents</h2>
        {{ .TableOfContents }}
      </div>
    </aside>

  </div>
</section>

{{/*  related articles  */}}
{{ $current := . }}
{{ $categories := .Params.categories }}

{{ if $categories }}
<section class="bg-mask py-10 px-5">
  <div class="max-w-7xl mx-auto space-y-10">
    <!-- Heading -->
    <div class="w-fit mx-auto" >
      <div class="w-10 sm:w-20 lg:w-30 max-h-30 relative left-0 sm:-left-14 lg:-left-20 -bottom-5" aria-hidden="true">
        <img src='{{ "images/dev/heading-icon.webp" | relURL }}' class="size-full">
      </div>
      <h2 class="text-light uppercase text-pretty text-center relative">Relate Articles</h2>
    </div>

    <!-- Swiper Section -->
    <div class="relative" >
      <!-- Prev Button -->
      <button aria-label="Previous article" class="prev-article cursor-pointer absolute -bottom-20 left-0 lg:left-60 xl:left-80 2xl:left-100">
        <svg class="size-10 text-primary" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill="currentColor" d="M15.2335 5.21967C15.5263 5.51256 15.5263 5.98744 15.2335 6.28033L9.51379 12L15.2335 17.7197C15.5263 18.0126 15.5263 18.4874 15.2335 18.7803C14.9406 19.0732 14.4657 19.0732 14.1728 18.7803L7.92279 12.5303C7.6299 12.2374 7.6299 11.7626 7.92279 11.4697L14.1728 5.21967C14.4657 4.92678 14.9406 4.92678 15.2335 5.21967Z"/>
        </svg>
      </button>

      <!-- Next Button -->
      <button aria-label="Next article" class="next-article cursor-pointer absolute -bottom-20 right-0 lg:right-60 xl:right-80 2xl:right-100">
        <svg class="size-10 text-primary rotate-180" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill="currentColor" d="M15.2335 5.21967C15.5263 5.51256 15.5263 5.98744 15.2335 6.28033L9.51379 12L15.2335 17.7197C15.5263 18.0126 15.5263 18.4874 15.2335 18.7803C14.9406 19.0732 14.4657 19.0732 14.1728 18.7803L7.92279 12.5303C7.6299 12.2374 7.6299 11.7626 7.92279 11.4697L14.1728 5.21967C14.4657 4.92678 14.9406 4.92678 15.2335 5.21967Z"/>
        </svg>
      </button>

      <!-- Swiper Wrapper -->
      <div class="swiper articleSwiper">
        <div class="swiper-wrapper">
          {{ range first 6 (where .Site.RegularPages "Params.categories" "intersect" $categories) }}
          {{ if ne .Permalink $current.Permalink }}
          <div class="swiper-slide">
            <a href="{{ .RelPermalink }}" class="inline-flex flex-col items-stretch group shadow-xl">
              <div class="overflow-hidden">
                {{ partial "components/image.html" (dict "src" .Params.image "alt" .Title "class" "size-full object-cover group-hover:scale-115 transition-transform duration-500") }}
              </div>
              <div class="row-span-2 flex flex-col gap-y-3 lg:gap-y-5 bg-glass p-3 lg:p-5">
                <div class="flex flex-wrap gap-3">
                  {{ with .PublishDate }}
                  <span class="text-light uppercase">{{ . | time.Format "02 Jan, 2006" }}</span>
                  {{ end }}
                  {{ $readingTime := div (float .WordCount) 170 | math.Ceil }}
                  <span class="text-primary uppercase">{{ $readingTime }} Min Read</span>
                </div>
                <h5 class="heading-sm text-light group-hover:text-primary transition-colors">{{ .Title }}</h5>
                <div>
                  {{ partial "components/button.html" (dict "label" "Read More" "link" "true" "url" .RelPermalink) }}
                </div>
              </div>
              <div class="h-1 w-full bg-light/20 relative overflow-hidden after:transition-transform after:duration-300 after:absolute after:inset-0 after:bg-primary after:-translate-x-full group-hover:after:translate-x-0"></div>
            </a>
          </div>
          {{ end }}
          {{ end }}
        </div>
      </div>
    </div>

    <!-- Explore All Button -->
    <div class="flex justify-center items-stretch">
      {{ partial "components/button.html" (dict "label" "Explore All" "link" "true" "url" "/blog/") }}
    </div>
  </div>
</section>
{{ end }}
{{/*  /related articles  */}}


{{ if eq .Parent.Title "Blog" }}
{{/* cta */}}
<section class="bg-mask py-10">
    {{ partial "shared/cta.html" }}
</section>
{{/* /cta */}}
{{ end }}



{{ end }}